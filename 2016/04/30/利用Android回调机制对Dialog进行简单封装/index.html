<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>利用Android回调机制对Dialog进行简单封装 | RoadToGeek技术小屋（少年，别再收藏文章了！）</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="写作原因：Android回调机制是Android开发者绕不开的一个点，对于它的掌握学习十分重要。本文由于作者水平有限可能存在纰漏，对于回调机制的学习掌握仍在途中，以后会推出更多的相关文章。

简介接口回调是Android中一种常用的机制，如Button点击事件就是接口回调的具体实现。Fragment与Activity之间的通信机制也是基于接口回调实现，感兴趣的可以阅读博主上篇关于Fragment通">
<meta property="og:type" content="article">
<meta property="og:title" content="利用Android回调机制对Dialog进行简单封装">
<meta property="og:url" content="http://yoursite.com/2016/04/30/利用Android回调机制对Dialog进行简单封装/index.html">
<meta property="og:site_name" content="RoadToGeek技术小屋（少年，别再收藏文章了！）">
<meta property="og:description" content="写作原因：Android回调机制是Android开发者绕不开的一个点，对于它的掌握学习十分重要。本文由于作者水平有限可能存在纰漏，对于回调机制的学习掌握仍在途中，以后会推出更多的相关文章。

简介接口回调是Android中一种常用的机制，如Button点击事件就是接口回调的具体实现。Fragment与Activity之间的通信机制也是基于接口回调实现，感兴趣的可以阅读博主上篇关于Fragment通">
<meta property="og:updated_time" content="2016-05-02T07:45:41.694Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="利用Android回调机制对Dialog进行简单封装">
<meta name="twitter:description" content="写作原因：Android回调机制是Android开发者绕不开的一个点，对于它的掌握学习十分重要。本文由于作者水平有限可能存在纰漏，对于回调机制的学习掌握仍在途中，以后会推出更多的相关文章。

简介接口回调是Android中一种常用的机制，如Button点击事件就是接口回调的具体实现。Fragment与Activity之间的通信机制也是基于接口回调实现，感兴趣的可以阅读博主上篇关于Fragment通">
  
    <link rel="alternate" href="/atom.xml" title="RoadToGeek技术小屋（少年，别再收藏文章了！）" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">RoadToGeek技术小屋（少年，别再收藏文章了！）</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">RoadToGeek技术小屋</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-利用Android回调机制对Dialog进行简单封装" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/30/利用Android回调机制对Dialog进行简单封装/" class="article-date">
  <time datetime="2016-04-30T04:59:55.000Z" itemprop="datePublished">2016-04-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android知识库/">Android知识库</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      利用Android回调机制对Dialog进行简单封装
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>写作原因：Android回调机制是Android开发者绕不开的一个点，对于它的掌握学习十分重要。本文由于作者水平有限可能存在纰漏，对于回调机制的学习掌握仍在途中，以后会推出更多的相关文章。</strong></p>
<hr>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>接口回调是Android中一种常用的机制，如Button点击事件就是接口回调的具体实现。Fragment与Activity之间的通信机制也是基于接口回调实现，感兴趣的可以阅读博主上篇关于Fragment通信的文章（基于Google官方文档）：<a href="http://roadtogeek.cn/2016/04/30/Fragment%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1/" target="_blank" rel="external">Fragment间的通信</a>。对于接口回调，作为初学者，个人有一下的一点认识：我们可以把接口看作是一个呼叫端口，是在某个功能类（发送方）完成自身功能过程中触发某些动作时通过接口中的某一个方法呼叫接口，然后接口将这种呼叫传至实现该接口的类（接收处理方）中，该类通过实现回调方法对该呼叫作出反馈。下面是Wikipedia上面关于回调机制的定义，有兴趣可以看看。</p>
<blockquote>
<p>In computer programming, a callback is a piece of executable code that is passed as an argument to other code, which is expected to call back (execute) the argument at some convenient time. The invocation may be immediate as in a synchronous callback, or it might happen at a later time as in an asynchronous callback. In all cases, the intention is to specify a function or subroutine as an entity that is, depending on the language, more or less similar to a variable.</p>
</blockquote>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>实现代码是最好的学习方式，下面博主通过封装一个简单的Dialog来讲解接口回调的具体用法。平常使用Dialog时如果按照标准写法来有时会显得很繁琐，博主因为特定需要将其封装成一个只有message和“确定”，“取消”按钮点击事件的工具。下面我将按照步骤一步步实现：</p>
<h3 id="定义接口"><a href="#定义接口" class="headerlink" title="定义接口"></a>定义接口</h3><p>在简介中已经说过，接口是一个呼叫端口，是通信的中介。内部的方法类比为不同请求。的本例中的接口是在我们点击Positive Button和Negative Button时被呼叫的。所以定义一下的接口：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface onButtonClick&#123;</span><br><span class="line">        public void OnPositive();</span><br><span class="line">        public void OnNegative();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>上面的接口中有两个方法，分别在点击Positive Button和Negative Button时回调</p>
<h3 id="实现接口"><a href="#实现接口" class="headerlink" title="实现接口"></a>实现接口</h3><p>这包括两个部分，一个是在功能类（发送方）向接口发出呼叫时实现回调：<br>先创建回调对象mCallBack：<br><code>private onButtonClick mButtonClickCallBack;</code><br>然后在触发某个动作时（当点击Dialog上的按钮时）发出回调（呼叫接口）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">builderSec.setPositiveButton(&quot;确定&quot;, new DialogInterface.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(DialogInterface dialog, int which) &#123;</span><br><span class="line"></span><br><span class="line">                mButtonClickCallBack.OnPositive();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        builderSec.setNegativeButton(&quot;取消&quot;, new DialogInterface.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(DialogInterface dialog, int which) &#123;</span><br><span class="line">                mButtonClickCallBack.OnNegative();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure></p>
<p>在另一个类（接收处理方）中实现回调方法对该呼叫作出反馈：<br>先实现该接口，可以在功能类中定义以下方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public void setOnButtonClick(onButtonClick mNegativeCallBack) &#123;</span><br><span class="line">        this.mButtonClickCallBack = mNegativeCallBack;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MyDialog deleteDialog = new MyDialog(getActivity(),&quot;RTGBrowser&quot;,&quot;是否删除当前历史记录？&quot;);</span><br><span class="line">                deleteDialog.setOnButtonClick(new MyDialog.onButtonClick() &#123;</span><br><span class="line">                    @Override</span><br><span class="line">                    public void OnPositive() &#123;</span><br><span class="line">                        //TODO:在这里实现点击Positive按钮的逻辑；</span><br><span class="line">                    &#125;</span><br><span class="line">                    @Override</span><br><span class="line">                    public void OnNegative() &#123;</span><br><span class="line">                        //TODO:在这里实现点击Negative按钮的逻辑；</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br></pre></td></tr></table></figure>
<p>这样就通过接口回调实现对一个Dialog进行封装，下面贴出完整的代码：</p>
<h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><p><strong>MyDialog.class</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">package com.example.vincebarry.exam.function;</span><br><span class="line">import android.content.Context;</span><br><span class="line">import android.content.DialogInterface;</span><br><span class="line">import android.support.v7.app.AlertDialog;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by VinceBarry on 2016/5/2.</span><br><span class="line"> * 那现在一起来总结一下基本的回调是如何实现的，首先创建一个接口，这个接口用于你在某个情景下执行相应的操作。</span><br><span class="line"> * 接着创建一个功能类，比如这个类可以显示一个对话框、可以滑动菜单、可以下载数据等等。</span><br><span class="line"> * 然后，在这个类里面声明回调接口的对象，之后在这个类里面创建在某个情景下需要执行的方法，而且在这个方法里面为声明的接口对象赋值。</span><br><span class="line"> * 最后在其他的类中使用这个功能类就可以了。所以说，最少也是需要三个类共同来完成这个回调机制。</span><br><span class="line"> */</span><br><span class="line">public class MyDialog &#123;</span><br><span class="line">    private onButtonClick mButtonClickCallBack;</span><br><span class="line">    private Context context;</span><br><span class="line">    private String title;</span><br><span class="line">    private String message;</span><br><span class="line">    AlertDialog.Builder builderSec;</span><br><span class="line">    public interface onButtonClick&#123;</span><br><span class="line">        public void OnPositive();</span><br><span class="line">        public void OnNegative();</span><br><span class="line">    &#125;</span><br><span class="line">    public MyDialog(Context context,String title,String message)&#123;</span><br><span class="line">        this.context = context;</span><br><span class="line">        this.title = title;</span><br><span class="line">        this.message = message;</span><br><span class="line">        builderSec = new AlertDialog.Builder(context);</span><br><span class="line">        builderSec.setTitle(title);</span><br><span class="line">        builderSec.setMessage(message);</span><br><span class="line">        builderSec.setPositiveButton(&quot;确定&quot;, new DialogInterface.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(DialogInterface dialog, int which) &#123;</span><br><span class="line"></span><br><span class="line">                mButtonClickCallBack.OnPositive();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        builderSec.setNegativeButton(&quot;取消&quot;, new DialogInterface.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(DialogInterface dialog, int which) &#123;</span><br><span class="line">                mButtonClickCallBack.OnNegative();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        AlertDialog dialogSec = builderSec.show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setOnButtonClick(onButtonClick mNegativeCallBack) &#123;</span><br><span class="line">        this.mButtonClickCallBack = mNegativeCallBack;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>MainActivity.class</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">MyDialog deleteDialog = new MyDialog(getActivity(),&quot;RTGBrowser&quot;,&quot;是否删除当前历史记录？&quot;);</span><br><span class="line">                deleteDialog.setOnButtonClick(new MyDialog.onButtonClick() &#123;</span><br><span class="line">                    @Override</span><br><span class="line">                    public void OnPositive() &#123;</span><br><span class="line">                        DataSupport.delete(TableHistoryLocal.class,positionInDb);</span><br><span class="line">                        queryAndTrans();</span><br><span class="line">                        roadData();</span><br><span class="line">                    &#125;</span><br><span class="line">                    @Override</span><br><span class="line">                    public void OnNegative() &#123;</span><br><span class="line">                        //donothing.</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br></pre></td></tr></table></figure></p>
<p>  水平不足，存在纰漏或错误请指教！！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/04/30/利用Android回调机制对Dialog进行简单封装/" data-id="cir1zx7cz001mxgyuf5bgkv43" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/原创/">原创</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/05/03/Android二维码扫描开发（一）：实现思路与原理/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Android二维码扫描开发（一）：实现思路与原理
        
      </div>
    </a>
  
  
    <a href="/2016/04/30/Fragment间的通信/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Fragment间的通信</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android-Google官方文档/">Android Google官方文档</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android-Studio/">Android Studio</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android-实战/">Android 实战</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android快速开发/">Android快速开发</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android知识库/">Android知识库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android第三方开源库/">Android第三方开源库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java基础知识/">Java基础知识</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux学习/">Linux学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python基础知识/">Python基础知识</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/心情随笔/">心情随笔</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/原创/">原创</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/心情/">心情</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/翻译/">翻译</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/转载/">转载</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 17.5px;">Android</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/原创/" style="font-size: 20px;">原创</a> <a href="/tags/心情/" style="font-size: 10px;">心情</a> <a href="/tags/翻译/" style="font-size: 12.5px;">翻译</a> <a href="/tags/转载/" style="font-size: 15px;">转载</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/07/25/小话java多线程机制/">小话java多线程机制</a>
          </li>
        
          <li>
            <a href="/2016/07/23/小话java注解机制/">小话java注解机制</a>
          </li>
        
          <li>
            <a href="/2016/07/23/小话java反射机制/">小话java反射机制</a>
          </li>
        
          <li>
            <a href="/2016/07/19/Android自定义View系列（二）——打造一个仿2K游戏摇杆/">Android自定义View系列（二）——打造一个仿2K游戏摇杆</a>
          </li>
        
          <li>
            <a href="/2016/07/18/Android自定义View系列（一）——打造一个爱心进度条/">Android自定义View系列（一）——打造一个爱心进度条</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 陈颍聪<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>